-- sequence for primary key column
CREATE SEQUENCE public.scan_result_header_seq
    INCREMENT 1
    START 2
    MINVALUE 1
    MAXVALUE 2147483647
    CACHE 1;

ALTER SEQUENCE public.scan_result_header_seq
    OWNER TO postgres;

DROP TABLE public.scan_results;

CREATE TABLE public.scan_results
(
    id               integer                  NOT NULL DEFAULT nextval('scan_result_header_seq'::regclass),
    scan_date        timestamp with time zone NOT NULL,
    plugin_id        character varying(30)    NOT NULL,
    plugin_name      character varying(250),
    family           character varying(50),
    severity         character varying(50),
    ip_addresss      character varying(50) NOT NULL,
    protocol         character varying(50) NOT NULL,
    port             character varying(50) NOT NULL,
    exploit          character varying(50),
    plugin_text      text,
    first_discovered timestamp with time zone NOT NULL,
    last_observed    timestamp with time zone,
    create_date      timestamp with time zone NOT NULL DEFAULT CURRENT_TIMESTAMP,
    update_date      timestamp with time zone,
    CONSTRAINT poam_header_pkey PRIMARY KEY (ID)
--    CONSTRAINT poam_header_poam_id UNIQUE (POAM_ID)
)
    TABLESPACE pg_default;

ALTER TABLE public.poam_header
    OWNER to postgres;

COMMENT ON COLUMN public.poam_header.month_year_added
    IS 'Month and year that POAM was added';

